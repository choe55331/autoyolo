# 🎮 화면 실시간 Rune 감지 가이드

게임이나 다른 프로그램 화면에서 학습한 Rune을 실시간으로 감지합니다!

---

## ⚡ 빠른 시작 (30초!)

### 1단계: 라이브러리 설치 (처음 한 번만)

```bash
pip install mss
```

### 2단계: 실행!

**방법 A: 배치 파일 (제일 쉬움!)**
```bash
화면_감지_시작.bat
```
더블클릭하면 끝! 😊

**방법 B: 명령어**
```bash
python detect_screen.py
```

### 3단계: 화면 영역 선택

```
사용 가능한 모니터:
  0. 전체 화면 1920x1080
  1. 모니터 1: 1920x1080
  2. 커스텀 영역

선택 (0-2): 1
```

### 4단계: 감지 시작!

감지 창이 뜨고 실시간으로 Rune을 찾아요! 🔍

---

## 🎯 사용 방법

### 기본 사용

```bash
# 대화형으로 영역 선택
python detect_screen.py

# 전체 화면 감지
python detect_screen.py --monitor 0

# 첫 번째 모니터만
python detect_screen.py --monitor 1
```

### 커스텀 영역 설정

특정 게임 창이나 영역만 감지하고 싶다면:

```bash
# 좌표로 직접 지정: X=100, Y=100, 너비=800, 높이=600
python detect_screen.py --region "100,100,800,600"
```

#### 💡 좌표 찾는 방법:

1. **Windows 그림판 사용**:
   - 그림판 열기
   - 커서를 원하는 위치에 놓기
   - 하단 상태바에 좌표 표시됨

2. **PowerToys 사용** (추천!):
   - Microsoft PowerToys 설치
   - Color Picker 실행 (Win + Shift + C)
   - 마우스로 좌표 확인

3. **마우스 좌표 확인 스크립트**:
   ```python
   # get_coordinates.py
   import pyautogui
   import time

   print("5초 후 마우스 위치를 확인합니다...")
   time.sleep(5)
   x, y = pyautogui.position()
   print(f"마우스 좌표: X={x}, Y={y}")
   ```

### 고급 옵션

```bash
# 신뢰도 임계값 조정 (기본: 0.25)
python detect_screen.py --conf 0.5

# IoU 임계값 조정
python detect_screen.py --iou 0.5

# FPS 표시 안 함
python detect_screen.py --no-fps

# 비디오 녹화
python detect_screen.py --save output/recording.mp4

# 모든 옵션 조합
python detect_screen.py --monitor 1 --conf 0.3 --save output/gameplay.mp4
```

---

## ⌨️ 단축키

감지 중에 사용할 수 있는 키:

| 키 | 기능 |
|----|------|
| **Q** | 종료 |
| **P** | 일시정지/재개 |
| **S** | 스크린샷 저장 |
| **C** | 신뢰도 임계값 변경 |

---

## 🎮 게임 화면 감지 예제

### 메이플스토리 Rune 감지

1. **게임 실행**

2. **게임 창 좌표 확인**
   - 게임 창을 원하는 위치로 이동
   - 좌상단 좌표 확인 (예: X=100, Y=50)
   - 게임 창 크기 확인 (예: 1280x720)

3. **감지 시작**
   ```bash
   python detect_screen.py --region "100,50,1280,720" --conf 0.3
   ```

4. **최적화**
   - 감지가 너무 많으면: `--conf 0.5` (신뢰도 올리기)
   - 감지가 부족하면: `--conf 0.2` (신뢰도 낮추기)

### 특정 UI 영역만 감지

Rune이 나타나는 화면의 특정 부분만 감지하면 더 빠릅니다!

```bash
# 예: 화면 중앙 400x400 영역만 감지
python detect_screen.py --region "760,340,400,400"
```

---

## 📊 성능 최적화

### FPS 향상 방법

#### 1. 감지 영역 줄이기
```bash
# 전체 화면 대신 작은 영역만
python detect_screen.py --region "100,100,800,600"
```

#### 2. 신뢰도 임계값 올리기
```bash
# 더 확실한 것만 감지 (처리 속도 향상)
python detect_screen.py --conf 0.5
```

#### 3. 더 작은 모델 사용
학습 시 `yolo12n` (nano) 모델을 사용하면 가장 빠릅니다.

#### 4. GPU 사용
GPU가 있다면 자동으로 사용되어 훨씬 빠릅니다!

### 예상 FPS

| 환경 | 해상도 | 예상 FPS |
|------|--------|----------|
| CPU (Intel i5) | 1920x1080 | 5-10 FPS |
| CPU (Intel i5) | 800x600 | 15-25 FPS |
| GPU (GTX 1060) | 1920x1080 | 30-60 FPS |
| GPU (RTX 3060) | 1920x1080 | 60-120 FPS |

---

## 🎬 비디오 녹화

### 기본 녹화

```bash
python detect_screen.py --save output/recording.mp4
```

### 특정 영역만 녹화

```bash
python detect_screen.py --region "100,100,1280,720" --save output/gameplay.mp4
```

### 고화질 녹화 팁

1. **녹화 전 output 폴더 확인**
   ```bash
   mkdir output
   ```

2. **충분한 디스크 공간 확보**
   - 1분당 약 10-50MB 사용

3. **감지 + 녹화는 CPU 부하가 큽니다**
   - 작은 영역만 녹화하세요
   - 또는 녹화 없이 스크린샷만 사용

---

## 🔧 문제 해결

### 문제 1: "ModuleNotFoundError: No module named 'mss'"

**해결:**
```bash
pip install mss
```

### 문제 2: 화면이 검게 나와요

**원인**: 일부 게임은 화면 캡처 방지 기능이 있어요.

**해결:**
- 게임을 창 모드로 실행
- 또는 전체 화면 캡처 사용

### 문제 3: FPS가 너무 낮아요

**해결:**
1. 감지 영역을 줄이세요
   ```bash
   python detect_screen.py --region "100,100,640,480"
   ```

2. 신뢰도를 올리세요
   ```bash
   python detect_screen.py --conf 0.5
   ```

3. 다른 프로그램을 종료하세요

### 문제 4: 모델을 찾을 수 없어요

**해결:**
```bash
# 모델 파일 확인
dir models\rune_detection\weights\best.pt

# 없으면 학습부터 진행
python train.py --data data/maple-rune-gloxg/data.yaml --epochs 10
```

### 문제 5: 감지가 너무 많이 돼요 (오탐지)

**해결:**
```bash
# 신뢰도 임계값을 올려서 확실한 것만 감지
python detect_screen.py --conf 0.5

# 또는 실행 중에 'C' 키를 눌러 변경
```

### 문제 6: 감지가 안 돼요

**해결:**
```bash
# 신뢰도 임계값을 낮춰서 더 많이 감지
python detect_screen.py --conf 0.15

# 또는 IoU 임계값 조정
python detect_screen.py --iou 0.3
```

---

## 💡 실전 팁

### 1. 게임 전용 프로필 만들기

게임별로 최적 설정을 배치 파일로 저장:

**maplestory_detect.bat**
```batch
@echo off
python detect_screen.py --region "100,50,1280,720" --conf 0.3 --save output/maple_%date%.mp4
```

### 2. 멀티 모니터 환경

모니터별로 감지:
```bash
# 주 모니터
python detect_screen.py --monitor 1

# 보조 모니터
python detect_screen.py --monitor 2
```

### 3. 자동 스크린샷

감지된 순간을 자동으로 저장하려면:
- 실행 중 'S' 키 반복 누르기
- 또는 코드 수정해서 자동 저장 기능 추가

### 4. 오버레이 모드

감지 결과를 게임 위에 오버레이하려면:
- OBS Studio 사용
- 감지 창을 OBS에 추가
- 투명도 조절

---

## 📖 추가 예제

### 예제 1: 메이플 보스 레이드

```bash
# 전체 화면, 높은 신뢰도, 녹화
python detect_screen.py --monitor 0 --conf 0.4 --save output/boss_raid.mp4
```

### 예제 2: 빠른 테스트

```bash
# 작은 영역, FPS 표시
python detect_screen.py --region "500,300,640,480"
```

### 예제 3: 정밀 감지

```bash
# 높은 신뢰도 + 낮은 IoU
python detect_screen.py --conf 0.6 --iou 0.3
```

---

## 🎯 다음 단계

화면 감지가 잘 작동하면:

1. **자동화 스크립트 만들기**
   - 특정 Rune 감지 시 알림 보내기
   - 자동으로 스크린샷 저장
   - 감지 로그 기록

2. **성능 개선**
   - 더 많은 데이터로 재학습
   - 더 큰 모델 사용 (yolo12s, yolo12m)
   - GPU 환경으로 이전

3. **공유하기**
   - 녹화한 영상 공유
   - 학습된 모델 공유
   - 다른 사람과 협업

---

**즐거운 Rune 감지 되세요!** 🎮✨

궁금한 점이 있으면 언제든 물어보세요!
